""" Utilities used to convert a field to human classic reprentation of data. """ from lib . hachoir_core . tools import ( humanDuration , humanFilesize , alignValue , durationWin64 as doDurationWin64 , deprecated ) from types import FunctionType , MethodType from lib . hachoir_core . field import Field def textHandler ( field , handler ) : assert isinstance ( handler , ( FunctionType , MethodType ) ) assert issubclass ( field . __class__ , Field ) field . createDisplay = lambda : handler ( field ) return field def displayHandler ( field , handler ) : assert isinstance ( handler , ( FunctionType , MethodType ) ) assert issubclass ( field . __class__ , Field ) field . createDisplay = lambda : handler ( field . value ) return field @ deprecated ( "Use TimedeltaWin64 field type" ) def durationWin64 ( field ) : assert hasattr ( field , "value" ) and hasattr ( field , "size" ) assert field . size == 64 delta = doDurationWin64 ( field . value ) return humanDuration ( delta ) def filesizeHandler ( field ) : return displayHandler ( field , humanFilesize ) def hexadecimal ( field ) : assert hasattr ( field , "value" ) and hasattr ( field , "size" ) size = field . size padding = alignValue ( size , 4 ) // 4 pattern = u"0x%%0%ux" % padding return pattern % field . value

import urllib import sickbeard from sickbeard import exceptions , logger from sickbeard import tvcache import generic class NZBsRUSProvider ( generic . NZBProvider ) : def __init__ ( self ) : generic . NZBProvider . __init__ ( self , "NZBs'R'US" ) self . cache = NZBsRUSCache ( self ) self . url = 'https://www.nzbsrus.com/' def isEnabled ( self ) : return sickbeard . NZBSRUS def _checkAuth ( self ) : if sickbeard . NZBSRUS_UID in ( None , "" ) or sickbeard . NZBSRUS_HASH in ( None , "" ) : raise exceptions . AuthException ( "NZBs'R'US authentication details are empty, check your config" ) class NZBsRUSCache ( tvcache . TVCache ) : def __init__ ( self , provider ) : tvcache . TVCache . __init__ ( self , provider ) self . minTime = 15 def _getRSSData ( self ) : url = self . provider . url + 'rssfeed.php?' urlArgs = { 'cat' : '91,75' , : sickbeard . NZBSRUS_UID , : sickbeard . NZBSRUS_HASH } url += urllib . urlencode ( urlArgs ) logger . log ( u"NZBs'R'US cache update URL: " + url , logger . DEBUG ) data = self . provider . getURL ( url ) return data def _checkAuth ( self , data ) : return data != 'Invalid Link'

from boto . s3 . key import Key class Object ( Key ) : def __init__ ( self , bucket , name = None ) : Key . __init__ ( self , bucket , name = name ) self . distribution = bucket . distribution def __repr__ ( self ) : return '<Object: %s/%s>' % ( self . distribution . config . origin , self . name ) def url ( self , scheme = 'http' ) : url = '%s://' % scheme url += self . distribution . domain_name if scheme . lower ( ) . startswith ( 'rtmp' ) : url += '/cfx/st/' else : url += '/' url += self . name return url class StreamingObject ( Object ) : def url ( self , scheme = 'rtmp' ) : return Object . url ( self , scheme )

def get ( prop , choices = None ) : prompt = prop . verbose_name if not prompt : prompt = prop . name if choices : if callable ( choices ) : choices = choices ( ) else : choices = prop . get_choices ( ) valid = False while not valid : if choices : min = 1 max = len ( choices ) for i in range ( min , max + 1 ) : value = choices [ i - 1 ] if isinstance ( value , tuple ) : value = value [ 0 ] print '[%d] %s' % ( i , value ) value = raw_input ( '%s [%d-%d]: ' % ( prompt , min , max ) ) try : int_value = int ( value ) value = choices [ int_value - 1 ] if isinstance ( value , tuple ) : value = value [ 1 ] valid = True except ValueError : print '%s is not a valid choice' % value except IndexError : print '%s is not within the range[%d-%d]' % ( min , max ) else : value = raw_input ( '%s: ' % prompt ) try : value = prop . validate ( value ) if prop . empty ( value ) and prop . required : print 'A value is required' else : valid = True except : print 'Invalid value: %s' % value return value

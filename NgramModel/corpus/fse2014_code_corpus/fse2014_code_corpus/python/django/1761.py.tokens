from MySQLdb . constants import FIELD_TYPE from django . contrib . gis . gdal import OGRGeomType from django . db . backends . mysql . introspection import DatabaseIntrospection class MySQLIntrospection ( DatabaseIntrospection ) : data_types_reverse = DatabaseIntrospection . data_types_reverse . copy ( ) data_types_reverse [ FIELD_TYPE . GEOMETRY ] = 'GeometryField' def get_geometry_type ( self , table_name , geo_col ) : cursor = self . connection . cursor ( ) try : cursor . execute ( 'DESCRIBE %s' % self . connection . ops . quote_name ( table_name ) ) for column , typ , null , key , default , extra in cursor . fetchall ( ) : if column == geo_col : field_type = OGRGeomType ( typ ) . django field_params = { } break finally : cursor . close ( ) return field_type , field_params

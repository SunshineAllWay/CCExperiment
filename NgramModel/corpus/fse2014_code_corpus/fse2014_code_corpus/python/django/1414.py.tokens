from django . contrib . webdesign . lorem_ipsum import words , paragraphs from django import template register = template . Library ( ) class LoremNode ( template . Node ) : def __init__ ( self , count , method , common ) : self . count , self . method , self . common = count , method , common def render ( self , context ) : try : count = int ( self . count . resolve ( context ) ) except ( ValueError , TypeError ) : count = 1 if self . method == 'w' : return words ( count , common = self . common ) else : paras = paragraphs ( count , common = self . common ) if self . method == 'p' : paras = [ '<p>%s</p>' % p for p in paras ] return u'\n\n' . join ( paras ) @ register . tag def lorem ( parser , token ) : bits = list ( token . split_contents ( ) ) tagname = bits [ 0 ] common = bits [ - 1 ] != 'random' if not common : bits . pop ( ) if bits [ - 1 ] in ( 'w' , 'p' , 'b' ) : method = bits . pop ( ) else : method = 'b' if len ( bits ) > 1 : count = bits . pop ( ) else : count = '1' count = parser . compile_filter ( count ) if len ( bits ) != 1 : raise template . TemplateSyntaxError ( "Incorrect format for %r tag" % tagname ) return LoremNode ( count , method , common )

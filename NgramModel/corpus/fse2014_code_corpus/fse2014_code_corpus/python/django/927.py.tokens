""" Clickjacking Protection Middleware. This module provides a middleware that implements protection against a malicious site loading resources from your site in a hidden frame. """ from django . conf import settings class XFrameOptionsMiddleware ( object ) : def process_response ( self , request , response ) : if response . get ( 'X-Frame-Options' , None ) is not None : return response if getattr ( response , 'xframe_options_exempt' , False ) : return response response [ 'X-Frame-Options' ] = self . get_xframe_options_value ( request , response ) return response def get_xframe_options_value ( self , request , response ) : return getattr ( settings , 'X_FRAME_OPTIONS' , 'SAMEORIGIN' ) . upper ( )

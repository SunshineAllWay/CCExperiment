""" Sets up the terminal color scheme. """ import os import sys from django . utils import termcolors def supports_color ( ) : unsupported_platform = ( sys . platform in ( 'win32' , 'Pocket PC' ) ) is_a_tty = hasattr ( sys . stdout , 'isatty' ) and sys . stdout . isatty ( ) if unsupported_platform or not is_a_tty : return False return True def color_style ( ) : if not supports_color ( ) : style = no_style ( ) else : DJANGO_COLORS = os . environ . get ( 'DJANGO_COLORS' , '' ) color_settings = termcolors . parse_color_setting ( DJANGO_COLORS ) if color_settings : class dummy : pass style = dummy ( ) for role in termcolors . PALETTES [ termcolors . NOCOLOR_PALETTE ] : format = color_settings . get ( role , { } ) setattr ( style , role , termcolors . make_style ( ** format ) ) style . ERROR_OUTPUT = style . ERROR else : style = no_style ( ) return style def no_style ( ) : class dummy : def __getattr__ ( self , attr ) : return lambda x : x return dummy ( )

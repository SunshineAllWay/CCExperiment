""" Tests for template filters (as opposed to template tags). The tests are hidden inside a function so that things like timestamps and timezones are only evaluated at the moment of execution and will therefore be consistent. """ from datetime import date , datetime , timedelta from django . utils . tzinfo import LocalTimezone , FixedOffset from django . utils . safestring import mark_safe class UnsafeClass : def __unicode__ ( self ) : return u'you & me' class SafeClass : def __unicode__ ( self ) : return mark_safe ( u'you &gt; me' ) def get_filter_tests ( ) : now = datetime . now ( ) now_tz = datetime . now ( LocalTimezone ( now ) ) now_tz_i = datetime . now ( FixedOffset ( ( 3 * 60 ) + 15 ) ) today = date . today ( ) return { : ( '{{ a|timesince }}' , { 'a' : datetime . now ( ) + timedelta ( minutes = - 1 , seconds = - 10 ) } , '1 minute' ) , : ( '{{ a|timesince }}' , { 'a' : datetime . now ( ) - timedelta ( days = 1 , minutes = 1 ) } , '1 day' ) , : ( '{{ a|timesince }}' , { 'a' : datetime . now ( ) - timedelta ( hours = 1 , minutes = 25 , seconds = 10 ) } , '1 hour, 25 minutes' ) , : ( '{{ a|timesince:b }}' , { 'a' : now - timedelta ( days = 2 ) , 'b' : now - timedelta ( days = 1 ) } , '1 day' ) , : ( '{{ a|timesince:b }}' , { 'a' : now - timedelta ( days = 2 , minutes = 1 ) , 'b' : now - timedelta ( days = 2 ) } , '1 minute' ) , : ( '{{ a|timesince:b }}' , { 'a' : now_tz - timedelta ( hours = 8 ) , 'b' : now_tz } , '8 hours' ) , : ( '{{ earlier|timesince }}' , { 'earlier' : now - timedelta ( days = 7 ) } , '1 week' ) , : ( '{{ earlier|timesince:now }}' , { 'now' : now , 'earlier' : now - timedelta ( days = 7 ) } , '1 week' ) , : ( '{{ later|timesince }}' , { 'later' : now + timedelta ( days = 7 ) } , '0 minutes' ) , : ( '{{ later|timesince:now }}' , { 'now' : now , 'later' : now + timedelta ( days = 7 ) } , '0 minutes' ) , : ( '{{ a|timesince }}' , { 'a' : now } , '0 minutes' ) , : ( '{{ a|timesince }}' , { 'a' : now_tz } , '0 minutes' ) , : ( '{{ a|timesince }}' , { 'a' : now_tz_i } , '0 minutes' ) , : ( '{{ a|timesince:b }}' , { 'a' : now_tz , 'b' : now_tz_i } , '0 minutes' ) , : ( '{{ a|timesince:b }}' , { 'a' : now , 'b' : now_tz_i } , '' ) , : ( '{{ a|timesince:b }}' , { 'a' : now_tz_i , 'b' : now } , '' ) , : ( '{{ a|timesince:b }}' , { 'a' : today , 'b' : today } , '0 minutes' ) , : ( '{{ a|timesince:b }}' , { 'a' : today , 'b' : today + timedelta ( hours = 24 ) } , '1 day' ) , : ( '{{ a|timeuntil }}' , { 'a' : datetime . now ( ) + timedelta ( minutes = 2 , seconds = 10 ) } , '2 minutes' ) , : ( '{{ a|timeuntil }}' , { 'a' : ( datetime . now ( ) + timedelta ( days = 1 , seconds = 10 ) ) } , '1 day' ) , : ( '{{ a|timeuntil }}' , { 'a' : ( datetime . now ( ) + timedelta ( hours = 8 , minutes = 10 , seconds = 10 ) ) } , '8 hours, 10 minutes' ) , : ( '{{ a|timeuntil:b }}' , { 'a' : now - timedelta ( days = 1 ) , 'b' : now - timedelta ( days = 2 ) } , '1 day' ) , : ( '{{ a|timeuntil:b }}' , { 'a' : now - timedelta ( days = 2 ) , 'b' : now - timedelta ( days = 2 , minutes = 1 ) } , '1 minute' ) , : ( '{{ earlier|timeuntil }}' , { 'earlier' : now - timedelta ( days = 7 ) } , '0 minutes' ) , : ( '{{ earlier|timeuntil:now }}' , { 'now' : now , 'earlier' : now - timedelta ( days = 7 ) } , '0 minutes' ) , : ( '{{ later|timeuntil }}' , { 'later' : now + timedelta ( days = 7 , hours = 1 ) } , '1 week' ) , : ( '{{ later|timeuntil:now }}' , { 'now' : now , 'later' : now + timedelta ( days = 7 ) } , '1 week' ) , : ( '{{ a|timeuntil }}' , { 'a' : now_tz_i } , '0 minutes' ) , : ( '{{ a|timeuntil:b }}' , { 'a' : now_tz_i , 'b' : now_tz } , '0 minutes' ) , : ( '{{ a|timeuntil:b }}' , { 'a' : today , 'b' : today } , '0 minutes' ) , : ( '{{ a|timeuntil:b }}' , { 'a' : today , 'b' : today - timedelta ( hours = 24 ) } , '1 day' ) , : ( "{% autoescape off %}{{ a|addslashes }} {{ b|addslashes }}{% endautoescape %}" , { "a" : "<a>'" , "b" : mark_safe ( "<a>'" ) } , ur"<a>\' <a>\'" ) , : ( "{{ a|addslashes }} {{ b|addslashes }}" , { "a" : "<a>'" , "b" : mark_safe ( "<a>'" ) } , ur"&lt;a&gt;\&#39; <a>\'" ) , : ( "{% autoescape off %}{{ a|capfirst }} {{ b|capfirst }}{% endautoescape %}" , { "a" : "fred>" , "b" : mark_safe ( "fred&gt;" ) } , u"Fred> Fred&gt;" ) , : ( "{{ a|capfirst }} {{ b|capfirst }}" , { "a" : "fred>" , "b" : mark_safe ( "fred&gt;" ) } , u"Fred&gt; Fred&gt;" ) , : ( "{% autoescape off %}{{ a|fix_ampersands }} {{ b|fix_ampersands }}{% endautoescape %}" , { "a" : "a&b" , "b" : mark_safe ( "a&b" ) } , u"a&amp;b a&amp;b" ) , : ( "{{ a|fix_ampersands }} {{ b|fix_ampersands }}" , { "a" : "a&b" , "b" : mark_safe ( "a&b" ) } , u"a&amp;amp;b a&amp;b" ) , : ( "{% autoescape off %}{{ a|floatformat }} {{ b|floatformat }}{% endautoescape %}" , { "a" : "1.42" , "b" : mark_safe ( "1.42" ) } , u"1.4 1.4" ) , : ( "{{ a|floatformat }} {{ b|floatformat }}" , { "a" : "1.42" , "b" : mark_safe ( "1.42" ) } , u"1.4 1.4" ) , : ( "{{ a|linenumbers }} {{ b|linenumbers }}" , { "a" : "one\n<two>\nthree" , "b" : mark_safe ( "one\n&lt;two&gt;\nthree" ) } , u"1. one\n2. &lt;two&gt;\n3. three 1. one\n2. &lt;two&gt;\n3. three" ) , : ( "{% autoescape off %}{{ a|linenumbers }} {{ b|linenumbers }}{% endautoescape %}" , { "a" : "one\n<two>\nthree" , "b" : mark_safe ( "one\n&lt;two&gt;\nthree" ) } , u"1. one\n2. <two>\n3. three 1. one\n2. &lt;two&gt;\n3. three" ) , : ( "{% autoescape off %}{{ a|lower }} {{ b|lower }}{% endautoescape %}" , { "a" : "Apple & banana" , "b" : mark_safe ( "Apple &amp; banana" ) } , u"apple & banana apple &amp; banana" ) , : ( "{{ a|lower }} {{ b|lower }}" , { "a" : "Apple & banana" , "b" : mark_safe ( "Apple &amp; banana" ) } , u"apple &amp; banana apple &amp; banana" ) , : ( "{% autoescape off %}{{ a|make_list }}{% endautoescape %}" , { "a" : mark_safe ( "&" ) } , u"[u'&']" ) , : ( "{{ a|make_list }}" , { "a" : mark_safe ( "&" ) } , u"[u&#39;&amp;&#39;]" ) , : ( '{% autoescape off %}{{ a|make_list|stringformat:"s"|safe }}{% endautoescape %}' , { "a" : mark_safe ( "&" ) } , u"[u'&']" ) , : ( '{{ a|make_list|stringformat:"s"|safe }}' , { "a" : mark_safe ( "&" ) } , u"[u'&']" ) , : ( "{% autoescape off %}{{ a|slugify }} {{ b|slugify }}{% endautoescape %}" , { "a" : "a & b" , "b" : mark_safe ( "a &amp; b" ) } , u"a-b a-amp-b" ) , : ( "{{ a|slugify }} {{ b|slugify }}" , { "a" : "a & b" , "b" : mark_safe ( "a &amp; b" ) } , u"a-b a-amp-b" ) , : ( '{% autoescape off %}.{{ a|stringformat:"5s" }}. .{{ b|stringformat:"5s" }}.{% endautoescape %}' , { "a" : "a<b" , "b" : mark_safe ( "a<b" ) } , u". a<b. . a<b." ) , : ( '.{{ a|stringformat:"5s" }}. .{{ b|stringformat:"5s" }}.' , { "a" : "a<b" , "b" : mark_safe ( "a<b" ) } , ) , : ( '{{ a|title }}' , { 'a' : 'JOE\'S CRAB SHACK' } , u'Joe&#39;s Crab Shack' ) , : ( '{{ a|title }}' , { 'a' : '555 WEST 53RD STREET' } , u'555 West 53rd Street' ) , : ( '{% autoescape off %}{{ a|truncatewords:"2" }} {{ b|truncatewords:"2"}}{% endautoescape %}' , { "a" : "alpha & bravo" , "b" : mark_safe ( "alpha &amp; bravo" ) } , u"alpha & ... alpha &amp; ..." ) , : ( '{{ a|truncatewords:"2" }} {{ b|truncatewords:"2"}}' , { "a" : "alpha & bravo" , "b" : mark_safe ( "alpha &amp; bravo" ) } , u"alpha &amp; ... alpha &amp; ..." ) , : ( '{{ a|truncatechars:5 }}' , { 'a' : "Testing, testing" } , u"Te..." ) , : ( '{{ a|truncatechars:7 }}' , { 'a' : "Testing" } , u"Testing" ) , : ( '{% autoescape off %}{{ a|upper }} {{ b|upper }}{% endautoescape %}' , { "a" : "a & b" , "b" : mark_safe ( "a &amp; b" ) } , u"A & B A &AMP; B" ) , : ( '{{ a|upper }} {{ b|upper }}' , { "a" : "a & b" , "b" : mark_safe ( "a &amp; b" ) } , u"A &amp; B A &amp;AMP; B" ) , : ( '{% autoescape off %}{{ a|urlize }} {{ b|urlize }}{% endautoescape %}' , { "a" : "http://example.com/?x=&y=" , "b" : mark_safe ( "http://example.com?x=&amp;y=" ) } , u'<a href="http://example.com/?x=&y=" rel="nofollow">http://example.com/?x=&y=</a> <a href="http://example.com?x=&amp;y=" rel="nofollow">http://example.com?x=&amp;y=</a>' ) , : ( '{{ a|urlize }} {{ b|urlize }}' , { "a" : "http://example.com/?x=&y=" , "b" : mark_safe ( "http://example.com?x=&amp;y=" ) } , u'<a href="http://example.com/?x=&amp;y=" rel="nofollow">http://example.com/?x=&amp;y=</a> <a href="http://example.com?x=&amp;y=" rel="nofollow">http://example.com?x=&amp;y=</a>' ) , : ( '{% autoescape off %}{{ a|urlize }}{% endautoescape %}' , { "a" : mark_safe ( "a &amp; b" ) } , 'a &amp; b' ) , : ( '{{ a|urlize }}' , { "a" : mark_safe ( "a &amp; b" ) } , 'a &amp; b' ) , : ( '{% autoescape off %}{{ a|urlize }}{% endautoescape %}' , { "a" : "<script>alert('foo')</script>" } , "<script>alert('foo')</script>" ) , : ( '{{ a|urlize }}' , { "a" : "<script>alert('foo')</script>" } , '&lt;script&gt;alert(&#39;foo&#39;)&lt;/script&gt;' ) , : ( '{{ a|urlize }}' , { "a" : "Email me at me@example.com" } , 'Email me at <a href="mailto:me@example.com">me@example.com</a>' ) , : ( '{{ a|urlize }}' , { "a" : "Email me at <me@example.com>" } , 'Email me at &lt;<a href="mailto:me@example.com">me@example.com</a>&gt;' ) , : ( '{% autoescape off %}{{ a|urlizetrunc:"8" }} {{ b|urlizetrunc:"8" }}{% endautoescape %}' , { "a" : '"Unsafe" http://example.com/x=&y=' , "b" : mark_safe ( '&quot;Safe&quot; http://example.com?x=&amp;y=' ) } , u'"Unsafe" <a href="http://example.com/x=&y=" rel="nofollow">http:...</a> &quot;Safe&quot; <a href="http://example.com?x=&amp;y=" rel="nofollow">http:...</a>' ) , : ( '{{ a|urlizetrunc:"8" }} {{ b|urlizetrunc:"8" }}' , { "a" : '"Unsafe" http://example.com/x=&y=' , "b" : mark_safe ( '&quot;Safe&quot; http://example.com?x=&amp;y=' ) } , u'&quot;Unsafe&quot; <a href="http://example.com/x=&amp;y=" rel="nofollow">http:...</a> &quot;Safe&quot; <a href="http://example.com?x=&amp;y=" rel="nofollow">http:...</a>' ) , : ( '{% autoescape off %}{{ a|wordcount }} {{ b|wordcount }}{% endautoescape %}' , { "a" : "a & b" , "b" : mark_safe ( "a &amp; b" ) } , "3 3" ) , : ( '{{ a|wordcount }} {{ b|wordcount }}' , { "a" : "a & b" , "b" : mark_safe ( "a &amp; b" ) } , "3 3" ) , : ( '{% autoescape off %}{{ a|wordwrap:"3" }} {{ b|wordwrap:"3" }}{% endautoescape %}' , { "a" : "a & b" , "b" : mark_safe ( "a & b" ) } , u"a &\nb a &\nb" ) , : ( '{{ a|wordwrap:"3" }} {{ b|wordwrap:"3" }}' , { "a" : "a & b" , "b" : mark_safe ( "a & b" ) } , u"a &amp;\nb a &\nb" ) , : ( '{% autoescape off %}.{{ a|ljust:"5" }}. .{{ b|ljust:"5" }}.{% endautoescape %}' , { "a" : "a&b" , "b" : mark_safe ( "a&b" ) } , u".a&b . .a&b ." ) , : ( '.{{ a|ljust:"5" }}. .{{ b|ljust:"5" }}.' , { "a" : "a&b" , "b" : mark_safe ( "a&b" ) } , u".a&amp;b . .a&b ." ) , : ( '{% autoescape off %}.{{ a|rjust:"5" }}. .{{ b|rjust:"5" }}.{% endautoescape %}' , { "a" : "a&b" , "b" : mark_safe ( "a&b" ) } , u". a&b. . a&b." ) , : ( '.{{ a|rjust:"5" }}. .{{ b|rjust:"5" }}.' , { "a" : "a&b" , "b" : mark_safe ( "a&b" ) } , u". a&amp;b. . a&b." ) , : ( '{% autoescape off %}.{{ a|center:"5" }}. .{{ b|center:"5" }}.{% endautoescape %}' , { "a" : "a&b" , "b" : mark_safe ( "a&b" ) } , u". a&b . . a&b ." ) , : ( '.{{ a|center:"5" }}. .{{ b|center:"5" }}.' , { "a" : "a&b" , "b" : mark_safe ( "a&b" ) } , u". a&amp;b . . a&b ." ) , : ( '{% autoescape off %}{{ a|cut:"x" }} {{ b|cut:"x" }}{% endautoescape %}' , { "a" : "x&y" , "b" : mark_safe ( "x&amp;y" ) } , u"&y &amp;y" ) , : ( '{{ a|cut:"x" }} {{ b|cut:"x" }}' , { "a" : "x&y" , "b" : mark_safe ( "x&amp;y" ) } , u"&amp;y &amp;y" ) , : ( '{% autoescape off %}{{ a|cut:"&" }} {{ b|cut:"&" }}{% endautoescape %}' , { "a" : "x&y" , "b" : mark_safe ( "x&amp;y" ) } , u"xy xamp;y" ) , : ( '{{ a|cut:"&" }} {{ b|cut:"&" }}' , { "a" : "x&y" , "b" : mark_safe ( "x&amp;y" ) } , u"xy xamp;y" ) , : ( '{% autoescape off %}{{ a|cut:";" }} {{ b|cut:";" }}{% endautoescape %}' , { "a" : "x&y" , "b" : mark_safe ( "x&amp;y" ) } , u"x&y x&ampy" ) , : ( '{{ a|cut:";" }} {{ b|cut:";" }}' , { "a" : "x&y" , "b" : mark_safe ( "x&amp;y" ) } , u"x&amp;y x&amp;ampy" ) , : ( '{{ a|escape }} {{ b|escape }}' , { "a" : "x&y" , "b" : mark_safe ( "x&y" ) } , u"x&amp;y x&y" ) , : ( '{% autoescape off %}{{ a|escape }} {{ b|escape }}{% endautoescape %}' , { "a" : "x&y" , "b" : mark_safe ( "x&y" ) } , "x&amp;y x&y" ) , : ( '{% autoescape off %}{{ a|escape|escape }}{% endautoescape %}' , { "a" : "x&y" } , u"x&amp;y" ) , : ( '{{ a|escape|escape }}' , { "a" : "x&y" } , u"x&amp;y" ) , : ( '{% autoescape off %}{{ a|force_escape }}{% endautoescape %}' , { "a" : "x&y" } , u"x&amp;y" ) , : ( '{{ a|force_escape }}' , { "a" : "x&y" } , u"x&amp;y" ) , : ( '{% autoescape off %}{{ a|force_escape|force_escape }}{% endautoescape %}' , { "a" : "x&y" } , u"x&amp;amp;y" ) , : ( '{{ a|force_escape|force_escape }}' , { "a" : "x&y" } , u"x&amp;amp;y" ) , : ( '{% autoescape off %}{{ a|force_escape|escape }}{% endautoescape %}' , { "a" : "x&y" } , u"x&amp;y" ) , : ( '{{ a|force_escape|escape }}' , { "a" : "x&y" } , u"x&amp;y" ) , : ( '{% autoescape off %}{{ a|escape|force_escape }}{% endautoescape %}' , { "a" : "x&y" } , u"x&amp;y" ) , : ( '{{ a|escape|force_escape }}' , { "a" : "x&y" } , u"x&amp;y" ) , : ( '{{ a|linebreaks }} {{ b|linebreaks }}' , { "a" : "x&\ny" , "b" : mark_safe ( "x&\ny" ) } , u"<p>x&amp;<br />y</p> <p>x&<br />y</p>" ) , : ( '{% autoescape off %}{{ a|linebreaks }} {{ b|linebreaks }}{% endautoescape %}' , { "a" : "x&\ny" , "b" : mark_safe ( "x&\ny" ) } , u"<p>x&<br />y</p> <p>x&<br />y</p>" ) , : ( '{{ a|linebreaksbr }} {{ b|linebreaksbr }}' , { "a" : "x&\ny" , "b" : mark_safe ( "x&\ny" ) } , u"x&amp;<br />y x&<br />y" ) , : ( '{% autoescape off %}{{ a|linebreaksbr }} {{ b|linebreaksbr }}{% endautoescape %}' , { "a" : "x&\ny" , "b" : mark_safe ( "x&\ny" ) } , u"x&<br />y x&<br />y" ) , : ( "{{ a }} -- {{ a|safe }}" , { "a" : u"<b>hello</b>" } , "&lt;b&gt;hello&lt;/b&gt; -- <b>hello</b>" ) , : ( "{% autoescape off %}{{ a }} -- {{ a|safe }}{% endautoescape %}" , { "a" : "<b>hello</b>" } , u"<b>hello</b> -- <b>hello</b>" ) , : ( '{{ a|join:", " }} -- {{ a|safeseq|join:", " }}' , { "a" : [ "&" , "<" ] } , "&amp;, &lt; -- &, <" ) , : ( '{% autoescape off %}{{ a|join:", " }} -- {{ a|safeseq|join:", " }}{% endautoescape %}' , { "a" : [ "&" , "<" ] } , "&, < -- &, <" ) , : ( '{{ a|removetags:"a b" }} {{ b|removetags:"a b" }}' , { "a" : "<a>x</a> <p><b>y</b></p>" , "b" : mark_safe ( "<a>x</a> <p><b>y</b></p>" ) } , u"x &lt;p&gt;y&lt;/p&gt; x <p>y</p>" ) , : ( '{% autoescape off %}{{ a|removetags:"a b" }} {{ b|removetags:"a b" }}{% endautoescape %}' , { "a" : "<a>x</a> <p><b>y</b></p>" , "b" : mark_safe ( "<a>x</a> <p><b>y</b></p>" ) } , u"x <p>y</p> x <p>y</p>" ) , : ( '{{ a|striptags }} {{ b|striptags }}' , { "a" : "<a>x</a> <p><b>y</b></p>" , "b" : mark_safe ( "<a>x</a> <p><b>y</b></p>" ) } , "x y x y" ) , : ( '{% autoescape off %}{{ a|striptags }} {{ b|striptags }}{% endautoescape %}' , { "a" : "<a>x</a> <p><b>y</b></p>" , "b" : mark_safe ( "<a>x</a> <p><b>y</b></p>" ) } , "x y x y" ) , : ( '{{ a|first }} {{ b|first }}' , { "a" : [ "a&b" , "x" ] , "b" : [ mark_safe ( "a&b" ) , "x" ] } , "a&amp;b a&b" ) , : ( '{% autoescape off %}{{ a|first }} {{ b|first }}{% endautoescape %}' , { "a" : [ "a&b" , "x" ] , "b" : [ mark_safe ( "a&b" ) , "x" ] } , "a&b a&b" ) , : ( '{{ a|last }} {{ b|last }}' , { "a" : [ "x" , "a&b" ] , "b" : [ "x" , mark_safe ( "a&b" ) ] } , "a&amp;b a&b" ) , : ( '{% autoescape off %}{{ a|last }} {{ b|last }}{% endautoescape %}' , { "a" : [ "x" , "a&b" ] , "b" : [ "x" , mark_safe ( "a&b" ) ] } , "a&b a&b" ) , : ( '{{ a|random }} {{ b|random }}' , { "a" : [ "a&b" , "a&b" ] , "b" : [ mark_safe ( "a&b" ) , mark_safe ( "a&b" ) ] } , "a&amp;b a&b" ) , : ( '{% autoescape off %}{{ a|random }} {{ b|random }}{% endautoescape %}' , { "a" : [ "a&b" , "a&b" ] , "b" : [ mark_safe ( "a&b" ) , mark_safe ( "a&b" ) ] } , "a&b a&b" ) , : ( '{{ a|slice:"1:3" }} {{ b|slice:"1:3" }}' , { "a" : "a&b" , "b" : mark_safe ( "a&b" ) } , "&amp;b &b" ) , : ( '{% autoescape off %}{{ a|slice:"1:3" }} {{ b|slice:"1:3" }}{% endautoescape %}' , { "a" : "a&b" , "b" : mark_safe ( "a&b" ) } , "&b &b" ) , : ( '{{ a|unordered_list }}' , { "a" : [ "x>" , [ [ "<y" , [ ] ] ] ] } , "\t<li>x&gt;\n\t<ul>\n\t\t<li>&lt;y</li>\n\t</ul>\n\t</li>" ) , : ( '{% autoescape off %}{{ a|unordered_list }}{% endautoescape %}' , { "a" : [ "x>" , [ [ "<y" , [ ] ] ] ] } , "\t<li>x>\n\t<ul>\n\t\t<li><y</li>\n\t</ul>\n\t</li>" ) , : ( '{{ a|unordered_list }}' , { "a" : [ "x>" , [ [ mark_safe ( "<y" ) , [ ] ] ] ] } , "\t<li>x&gt;\n\t<ul>\n\t\t<li><y</li>\n\t</ul>\n\t</li>" ) , : ( '{% autoescape off %}{{ a|unordered_list }}{% endautoescape %}' , { "a" : [ "x>" , [ [ mark_safe ( "<y" ) , [ ] ] ] ] } , "\t<li>x>\n\t<ul>\n\t\t<li><y</li>\n\t</ul>\n\t</li>" ) , : ( '{% autoescape off %}{{ a|unordered_list }}{% endautoescape %}' , { "a" : [ "x>" , [ [ "<y" , [ ] ] ] ] } , "\t<li>x>\n\t<ul>\n\t\t<li><y</li>\n\t</ul>\n\t</li>" ) , : ( '{{ a|default:"x<" }}' , { "a" : "" } , "x<" ) , : ( '{% autoescape off %}{{ a|default:"x<" }}{% endautoescape %}' , { "a" : "" } , "x<" ) , : ( '{{ a|default:"x<" }}' , { "a" : mark_safe ( "x>" ) } , "x>" ) , : ( '{% autoescape off %}{{ a|default:"x<" }}{% endautoescape %}' , { "a" : mark_safe ( "x>" ) } , "x>" ) , : ( '{{ a|default:"x<" }}' , { "a" : None } , "x<" ) , : ( '{% autoescape off %}{{ a|default:"x<" }}{% endautoescape %}' , { "a" : None } , "x<" ) , : ( '{{ a|phone2numeric }} {{ b|phone2numeric }}' , { "a" : "<1-800-call-me>" , "b" : mark_safe ( "<1-800-call-me>" ) } , "&lt;1-800-2255-63&gt; <1-800-2255-63>" ) , : ( '{% autoescape off %}{{ a|phone2numeric }} {{ b|phone2numeric }}{% endautoescape %}' , { "a" : "<1-800-call-me>" , "b" : mark_safe ( "<1-800-call-me>" ) } , "<1-800-2255-63> <1-800-2255-63>" ) , : ( '{{ a|phone2numeric }}' , { "a" : "How razorback-jumping frogs can level six piqued gymnasts!" } , "469 729672225-5867464 37647 226 53835 749 747833 49662787!" ) , : ( '{{ url|iriencode }}' , { 'url' : '?test=1&me=2' } , '?test=1&amp;me=2' ) , : ( '{% autoescape off %}{{ url|iriencode }}{% endautoescape %}' , { 'url' : '?test=1&me=2' } , '?test=1&me=2' ) , : ( '{{ url|iriencode }}' , { 'url' : mark_safe ( '?test=1&me=2' ) } , '?test=1&me=2' ) , : ( '{% autoescape off %}{{ url|iriencode }}{% endautoescape %}' , { 'url' : mark_safe ( '?test=1&me=2' ) } , '?test=1&me=2' ) , : ( '{{ url|urlencode }}' , { 'url' : '/test&"/me?/' } , '/test%26%22/me%3F/' ) , : ( '/test/{{ urlbit|urlencode:"" }}/' , { 'urlbit' : 'escape/slash' } , '/test/escape%2Fslash/' ) , : ( '{{ a|capfirst|center:"7" }}.{{ b|capfirst|center:"7" }}' , { "a" : "a < b" , "b" : mark_safe ( "a < b" ) } , " A &lt; b . A < b " ) , : ( '{% autoescape off %}{{ a|capfirst|center:"7" }}.{{ b|capfirst|center:"7" }}{% endautoescape %}' , { "a" : "a < b" , "b" : mark_safe ( "a < b" ) } , " A < b . A < b " ) , : ( '{{ a|cut:"b"|capfirst }}.{{ b|cut:"b"|capfirst }}' , { "a" : "a < b" , "b" : mark_safe ( "a < b" ) } , "A &lt; .A < " ) , : ( '{% autoescape off %}{{ a|cut:"b"|capfirst }}.{{ b|cut:"b"|capfirst }}{% endautoescape %}' , { "a" : "a < b" , "b" : mark_safe ( "a < b" ) } , "A < .A < " ) , : ( '{{ a|escape|capfirst }}' , { "a" : "a < b" } , "A &lt; b" ) , : ( '{% autoescape off %}{{ a|escape|capfirst }}{% endautoescape %}' , { "a" : "a < b" } , "A &lt; b" ) , : ( '{{ a|force_escape|cut:";" }}' , { "a" : "a < b" } , "a &amp;lt b" ) , : ( '{% autoescape off %}{{ a|force_escape|cut:";" }}{% endautoescape %}' , { "a" : "a < b" } , "a &lt b" ) , : ( '{{ a|cut:";"|force_escape }}' , { "a" : "a < b" } , "a &lt; b" ) , : ( '{% autoescape off %}{{ a|cut:";"|force_escape }}{% endautoescape %}' , { "a" : "a < b" } , "a &lt; b" ) , : ( '{{ a|cut:"b"|safe }}' , { "a" : "a < b" } , "a < " ) , : ( '{% autoescape off %}{{ a|cut:"b"|safe }}{% endautoescape %}' , { "a" : "a < b" } , "a < " ) , : ( '{{ a|safe|force_escape }}' , { "a" : "a < b" } , "a &lt; b" ) , : ( '{% autoescape off %}{{ a|safe|force_escape }}{% endautoescape %}' , { "a" : "a < b" } , "a &lt; b" ) , : ( r'{{ unsafe|capfirst }}' , { 'unsafe' : UnsafeClass ( ) } , 'You &amp; me' ) , : ( r'{% autoescape off %}{{ unsafe|capfirst }}{% endautoescape %}' , { 'unsafe' : UnsafeClass ( ) } , 'You & me' ) , : ( r'{{ safe|capfirst }}' , { 'safe' : SafeClass ( ) } , 'You &gt; me' ) , : ( r'{% autoescape off %}{{ safe|capfirst }}{% endautoescape %}' , { 'safe' : SafeClass ( ) } , 'You &gt; me' ) , : ( r'{{ a|escapejs }}' , { 'a' : 'testing\r\njavascript \'string" <b>escaping</b>' } , 'testing\\u000D\\u000Ajavascript \\u0027string\\u0022 \\u003Cb\\u003Eescaping\\u003C/b\\u003E' ) , : ( r'{% autoescape off %}{{ a|escapejs }}{% endautoescape %}' , { 'a' : 'testing\r\njavascript \'string" <b>escaping</b>' } , 'testing\\u000D\\u000Ajavascript \\u0027string\\u0022 \\u003Cb\\u003Eescaping\\u003C/b\\u003E' ) , : ( '{{ list|length }}' , { 'list' : [ '4' , None , True , { } ] } , '4' ) , : ( '{{ list|length }}' , { 'list' : [ ] } , '0' ) , : ( '{{ string|length }}' , { 'string' : '' } , '0' ) , : ( '{{ string|length }}' , { 'string' : 'django' } , '6' ) , : ( '{{ int|length }}' , { 'int' : 7 } , '' ) , : ( '{{ None|length }}' , { 'None' : None } , '' ) , : ( '{% if some_list|length_is:"4" %}Four{% endif %}' , { 'some_list' : [ '4' , None , True , { } ] } , 'Four' ) , : ( '{% if some_list|length_is:"4" %}Four{% else %}Not Four{% endif %}' , { 'some_list' : [ '4' , None , True , { } , 17 ] } , 'Not Four' ) , : ( '{% if mystring|length_is:"4" %}Four{% endif %}' , { 'mystring' : 'word' } , 'Four' ) , : ( '{% if mystring|length_is:"4" %}Four{% else %}Not Four{% endif %}' , { 'mystring' : 'Python' } , 'Not Four' ) , : ( '{% if mystring|length_is:"4" %}Four{% else %}Not Four{% endif %}' , { 'mystring' : '' } , 'Not Four' ) , : ( '{% with var|length as my_length %}{{ my_length }}{% endwith %}' , { 'var' : 'django' } , '6' ) , : ( r'{% if "X"|length_is:0 %}Length is 0{% else %}Length not 0{% endif %}' , { } , 'Length not 0' ) , : ( r'{% if "X"|length_is:1 %}Length is 1{% else %}Length not 1{% endif %}' , { } , 'Length is 1' ) , : ( '{{ var|length_is:"fish" }}' , { 'var' : 'django' } , '' ) , : ( '{{ int|length_is:"1" }}' , { 'int' : 7 } , '' ) , : ( '{{ none|length_is:"1" }}' , { 'none' : None } , '' ) , : ( r'{{ a|join:", " }}' , { 'a' : [ 'alpha' , 'beta & me' ] } , 'alpha, beta &amp; me' ) , : ( r'{% autoescape off %}{{ a|join:", " }}{% endautoescape %}' , { 'a' : [ 'alpha' , 'beta & me' ] } , 'alpha, beta & me' ) , : ( r'{{ a|join:" &amp; " }}' , { 'a' : [ 'alpha' , 'beta & me' ] } , 'alpha &amp; beta &amp; me' ) , : ( r'{% autoescape off %}{{ a|join:" &amp; " }}{% endautoescape %}' , { 'a' : [ 'alpha' , 'beta & me' ] } , 'alpha &amp; beta & me' ) , : ( r'{{ a|join:var }}' , { 'a' : [ 'alpha' , 'beta & me' ] , 'var' : ' & ' } , 'alpha &amp; beta &amp; me' ) , : ( r'{{ a|join:var }}' , { 'a' : [ 'alpha' , 'beta & me' ] , 'var' : mark_safe ( ' & ' ) } , 'alpha & beta &amp; me' ) , : ( r'{{ a|join:var|lower }}' , { 'a' : [ 'Alpha' , 'Beta & me' ] , 'var' : ' & ' } , 'alpha &amp; beta &amp; me' ) , : ( r'{{ a|join:var|lower }}' , { 'a' : [ 'Alpha' , 'Beta & me' ] , 'var' : mark_safe ( ' & ' ) } , 'alpha & beta &amp; me' ) , : ( r'{{ d|date:"m" }}' , { 'd' : datetime ( 2008 , 1 , 1 ) } , '01' ) , : ( r'{{ d|date }}' , { 'd' : datetime ( 2008 , 1 , 1 ) } , 'Jan. 1, 2008' ) , : ( r'{{ d|date:"m" }}' , { 'd' : 'fail_string' } , '' ) , : ( r'{{ d|date:"o" }}' , { 'd' : datetime ( 2008 , 12 , 29 ) } , '2009' ) , : ( r'{{ d|date:"o" }}' , { 'd' : datetime ( 2010 , 1 , 3 ) } , '2009' ) , : ( r'{{ d|date:"e" }}' , { 'd' : datetime ( 2009 , 3 , 12 , tzinfo = FixedOffset ( 30 ) ) } , '+0030' ) , : ( r'{{ d|date:"e" }}' , { 'd' : datetime ( 2009 , 3 , 12 ) } , '' ) , : ( r'{{ i|add:"5" }}' , { 'i' : 2000 } , '2005' ) , : ( r'{{ i|add:"napis" }}' , { 'i' : 2000 } , '' ) , : ( r'{{ i|add:16 }}' , { 'i' : 'not_an_int' } , '' ) , : ( r'{{ i|add:"16" }}' , { 'i' : 'not_an_int' } , 'not_an_int16' ) , : ( r'{{ l1|add:l2 }}' , { 'l1' : [ 1 , 2 ] , 'l2' : [ 3 , 4 ] } , '[1, 2, 3, 4]' ) , : ( r'{{ t1|add:t2 }}' , { 't1' : ( 3 , 4 ) , 't2' : ( 1 , 2 ) } , '(3, 4, 1, 2)' ) , : ( r'{{ d|add:t }}' , { 'd' : date ( 2000 , 1 , 1 ) , 't' : timedelta ( 10 ) } , 'Jan. 11, 2000' ) , }

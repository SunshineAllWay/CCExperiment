from django . core import urlresolvers from django . contrib . sitemaps import Sitemap class GeoRSSSitemap ( Sitemap ) : def __init__ ( self , feed_dict , slug_dict = None ) : self . feed_dict = feed_dict self . locations = [ ] if slug_dict is None : slug_dict = { } for section in feed_dict . keys ( ) : if slug_dict . get ( section , False ) : for slug in slug_dict [ section ] : self . locations . append ( '%s/%s' % ( section , slug ) ) else : self . locations . append ( section ) def get_urls ( self , page = 1 , site = None ) : urls = Sitemap . get_urls ( self , page = page , site = site ) for url in urls : url [ 'geo_format' ] = 'georss' return urls def items ( self ) : return self . locations def location ( self , obj ) : return urlresolvers . reverse ( 'django.contrib.gis.views.feed' , args = ( obj , ) )

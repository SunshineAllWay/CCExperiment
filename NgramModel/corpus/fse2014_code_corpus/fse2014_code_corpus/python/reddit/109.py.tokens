from r2 . models import Link , Subreddit from r2 . lib import utils from pylons import g count_period = g . rising_period def incr_counts ( wrapped ) : pass def incr_sr_count ( sr ) : pass def get_link_counts ( period = count_period ) : links = Link . _query ( Link . c . _date >= utils . timeago ( period ) , limit = 50 , data = True ) return dict ( ( l . _fullname , ( 0 , l . sr_id ) ) for l in links ) def get_sr_counts ( ) : srs = utils . fetch_things2 ( Subreddit . _query ( ) ) return dict ( ( sr . _fullname , sr . _ups ) for sr in srs ) try : from r2admin . lib . count import * except ImportError : pass

import boto from boto . s3 . connection import S3Connection from boto . s3 . key import Key from pylons import g KEY_ID = g . S3KEY_ID SECRET_KEY = g . S3SECRET_KEY NEVER = 'Thu, 31 Dec 2037 23:59:59 GMT' class S3Exception ( Exception ) : pass def send_file ( bucketname , filename , content , content_type = 'text/plain' , never_expire = False , replace = True , reduced_redundancy = False ) : connection = S3Connection ( KEY_ID , SECRET_KEY ) bucket = connection . get_bucket ( bucketname ) k = bucket . new_key ( filename ) headers = { 'Content-Type' : content_type } if never_expire : headers [ 'Expires' ] = NEVER k . set_contents_from_string ( content , policy = 'public-read' , headers = headers , replace = replace , reduced_redundancy = reduced_redundancy )

from django . conf import settings from urlparse import urlparse import re any_path_re = re . compile ( '^/?[a-zA-Z0-9_.-]+(/[a-zA-Z0-9_.-]+)*/?$' ) def levelize_path ( path ) : parts = path . rstrip ( "/" ) . split ( "/" ) paths = [ ] for i in range ( len ( parts ) , 0 , - 1 ) : sub_path = ( '/' ) . join ( parts [ : i ] ) if sub_path : paths . append ( sub_path ) return paths def urljoin ( * segments ) : cleaned_segments = map ( lambda segment : unicode ( segment ) . strip ( "/" ) , segments ) nonempty_segments = filter ( lambda segment : segment > "" , cleaned_segments ) url = ( "/" ) . join ( nonempty_segments ) if segments [ 0 ] . startswith ( "/" ) and not url . startswith ( "/" ) : url = "/" + url if settings . APPEND_SLASH and not url . endswith ( "/" ) : url += "/" return url def is_media_request ( request ) : parsed_media_url = urlparse ( settings . MEDIA_URL ) if request . path . startswith ( parsed_media_url . path ) : if parsed_media_url . netloc : if request . get_host ( ) == parsed_media_url . netloc : return True else : return True

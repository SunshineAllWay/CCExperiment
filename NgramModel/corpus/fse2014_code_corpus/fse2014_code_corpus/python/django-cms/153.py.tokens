from django . db import models from south . db import db from south . v2 import DataMigration import datetime import traceback class Migration ( DataMigration ) : def forwards ( self , orm ) : for textplugin in orm . Text . objects . all ( ) : try : textplugin . full_clean ( ) except : traceback . print_exc ( ) print 'ERROR CLEANING TEXT PLUGIN %s, PLEASE FIX MANUALLY' % textplugin . pk textplugin . save ( ) def backwards ( self , orm ) : models = { : { : { 'object_name' : 'CMSPlugin' } , : ( 'django.db.models.fields.DateTimeField' , [ ] , { 'default' : 'datetime.datetime.now' } ) , : ( 'django.db.models.fields.AutoField' , [ ] , { 'primary_key' : 'True' } ) , : ( 'django.db.models.fields.CharField' , [ ] , { 'max_length' : '15' , 'db_index' : 'True' } ) , : ( 'django.db.models.fields.PositiveIntegerField' , [ ] , { 'db_index' : 'True' } ) , : ( 'django.db.models.fields.PositiveIntegerField' , [ ] , { 'db_index' : 'True' } ) , : ( 'django.db.models.fields.related.ForeignKey' , [ ] , { 'to' : "orm['cms.CMSPlugin']" , 'null' : 'True' , 'blank' : 'True' } ) , : ( 'django.db.models.fields.related.ForeignKey' , [ ] , { 'to' : "orm['cms.Placeholder']" , 'null' : 'True' } ) , : ( 'django.db.models.fields.CharField' , [ ] , { 'max_length' : '50' , 'db_index' : 'True' } ) , : ( 'django.db.models.fields.PositiveSmallIntegerField' , [ ] , { 'null' : 'True' , 'blank' : 'True' } ) , : ( 'django.db.models.fields.PositiveIntegerField' , [ ] , { 'db_index' : 'True' } ) , : ( 'django.db.models.fields.PositiveIntegerField' , [ ] , { 'db_index' : 'True' } ) } , : { : { 'object_name' : 'Placeholder' } , : ( 'django.db.models.fields.PositiveSmallIntegerField' , [ ] , { 'null' : 'True' } ) , : ( 'django.db.models.fields.AutoField' , [ ] , { 'primary_key' : 'True' } ) , : ( 'django.db.models.fields.CharField' , [ ] , { 'max_length' : '50' , 'db_index' : 'True' } ) } , : { : { 'object_name' : 'Text' , 'db_table' : "'cmsplugin_text'" } , : ( 'django.db.models.fields.TextField' , [ ] , { } ) , : ( 'django.db.models.fields.related.OneToOneField' , [ ] , { 'to' : "orm['cms.CMSPlugin']" , 'unique' : 'True' , 'primary_key' : True } ) } } complete_apps = [ 'text' ]
